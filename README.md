# SP-Rank: A Dataset for Ranked Preferences with Secondary Information

This repository contains the code accompanying the paper *SP-Rank: A Dataset for Ranked Preferences with Secondary Information*, designed to evaluate rank aggregation methods that combine first-order signals (votes) and second-order signals (meta-predictions of othersâ€™ votes).

## ðŸ›  Development Environment Setup

To run this codebase, ensure the following:

- Python 3.7.12
- `pystan` installed per the instructions at: https://pystan.readthedocs.io/en/latest/

After setting up the environment, unzip the `SP_Rank_Code` folder and execute the files in the order described below.

---

## Code Execution Workflow

### 1. `data_distribution_and_voter_accuracy.ipynb`
- Generates plots showing:
  - Distribution of datapoints across elicitation formats
  - Voter accuracies based on vote-only responses
- Useful for an initial exploratory analysis of the dataset.

---

### 2. `full_ground_truth_recovery.py`
- Benchmarks full ground-truth rank recovery across aggregation methods.
- **Important**: The dataset contains two disjoint subsets (4-alternative and 5-alternative conditions).
  Use the following filters:
  - `df = df[df['workerid'] <= 720].copy()` â†’ for **4 alternatives**
  - `df = df[df['workerid'] > 720].copy()` â†’ for **5 alternatives**
- Do **not** run the script on the full dataset simultaneously, as ground truth differs between subsets.

---

### 3. `subset_ground_truth_recovery.py`
- Benchmarks **subset-level** ground-truth recovery using the same aggregation methods.
- Apply the same `workerid` filter as in Step 2 to select the appropriate condition.

---

### 4. `benchmarking_calculations.ipynb`
- Aggregates benchmark results for both full and subset-level recovery tasks.
- Produces summary statistics and tables used in the paper.

---

### 5. `mallows_model.ipynb`
- Simulates and evaluates parameter recovery using the **Mallows model** with 2 and 3 latent voter groups.
- Relies on intermediate inputs generated by steps (2) and (3).

---

### 6. `plackett_luce_model.ipynb`
- Simulates and evaluates parameter recovery using the **Plackettâ€“Luce model** with 2 and 3 latent voter groups.
- Also depends on outputs from steps (2) and (3).

---

## Output

Each script or notebook generates CSV files and plots suitable for further analysis or visualization. Ensure the correct working directory paths are set when running the code.

---

## Questions or Issues

If you encounter problems or have questions, feel free to open an issue or contact the authors.
